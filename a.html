<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>×“×•×— ×§×•×¤×•×ª ×œ×”×“×¤×¡×”</title>
    <style>
        /* --- ×¢×™×¦×•×‘ ×›×œ×œ×™ --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f0f2f5;
            color: #333;
        }

        /* --- ××–×•×¨ ×›×•×ª×¨×•×ª (×œ××¢×œ×”) --- */
        .header-container {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            gap: 40px;
            border: 1px solid #ddd;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .input-group input {
            padding: 8px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 200px;
        }

        /* --- ××–×•×¨ ×›×¤×ª×•×¨×™× (×œ× ××•×“×¤×¡) --- */
        .toolbar {
            background: #e4e6eb;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
            border: 1px solid #ccc;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            font-size: 15px;
            font-weight: bold;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.2s;
        }

        button:hover { opacity: 0.9; }

        .btn-add { background-color: #28a745; } /* ×™×¨×•×§ */
        .btn-print { background-color: #007bff; } /* ×›×—×•×œ */
        .btn-empty { background-color: #6f42c1; border: 2px solid #5a32a3; } /* ×¡×’×•×œ - ×œ×”×“×¤×¡×” ×¨×™×§×” */
        .btn-reset { background-color: #dc3545; } /* ××“×•× */

        /* --- ×˜×‘×œ×” --- */
        .table-wrap {
            background: #fff;
            border: 1px solid #ccc;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #bbb;
            padding: 12px; /* ×¨×•×•×— × ×— ×œ×›×ª×™×‘×” */
            text-align: right;
            height: 35px; /* ×’×•×‘×” ×©×•×¨×” ×§×‘×•×¢ */
        }

        th {
            background-color: #343a40;
            color: white;
            -webkit-print-color-adjust: exact;
        }

        /* ×©×“×•×ª ×§×œ×˜ ×‘×˜×‘×œ×” */
        td input {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            font-size: 16px;
            background: transparent;
        }

        /* --- ×”×’×“×¨×•×ª ×”×“×¤×¡×” --- */
        @media print {
            @page { margin: 10mm; size: A4 landscape; } /* ×“×£ ×œ×¨×•×—×‘ */
            
            body { 
                background: white; 
                margin: 0; 
                -webkit-print-color-adjust: exact; 
            }
            
            .toolbar, .no-print { display: none !important; } /* ×”×¡×ª×¨×ª ×›×¤×ª×•×¨×™× */

            .header-container {
                box-shadow: none;
                border: none;
                padding: 0;
                margin-bottom: 10px;
            }

            .header-container input {
                border: none;
                border-bottom: 1px solid #000;
                width: 150px;
            }

            .table-wrap { box-shadow: none; border: none; }
            
            table { border: 2px solid #000; }
            th, td { border: 1px solid #000; color: black !important; }
            th { background-color: #eee !important; color: black !important; }
            
            /* ×”×‘×˜×—×ª ×’×•×‘×” ×©×•×¨×” ×‘×”×“×¤×¡×” ×œ×›×ª×™×‘×” ×™×“× ×™×ª */
            tr { height: 40px; } 
        }
    </style>
</head>
<body>

    <div class="header-container">
        <div class="input-group">
            <label>×™×•×:</label>
            <input type="text" id="dayInput" placeholder="...">
        </div>
        <div class="input-group">
            <label>×©×:</label>
            <input type="text" id="nameInput" placeholder="...">
        </div>
        <div class="input-group">
            <label>×©× ×§×•×¤×”/×§×•:</label>
            <input type="text" id="routeInput" placeholder="...">
        </div>
    </div>

    <div class="toolbar">
        <button class="btn-empty" onclick="printEmptySheet()">ğŸ–¨ï¸ ×”×“×¤×¡ ×“×£ ×¨×™×§ ×œ××™×œ×•×™</button>
        <div style="border-left: 2px solid #ccc; height: 30px; margin: 0 10px;"></div> <button class="btn-add" onclick="addRow()">+ ×”×•×¡×£ ×©×•×¨×”</button>
        <button class="btn-print" onclick="window.print()">×”×“×¤×¡ ××¦×‘ × ×•×›×—×™</button>
        <button class="btn-reset" onclick="resetAll()">× ×§×” ×”×›×œ</button>
    </div>

    <div class="table-wrap">
        <table id="mainTable">
            <thead>
                <tr>
                    <th style="width: 25%">×©× ×§×•×¤×”</th>
                    <th style="width: 15%">××¡' ××©×˜×—×™×</th>
                    <th style="width: 15%">×›××•×ª ××©×—×§×™×</th>
                    <th style="width: 20%">×”×•×“×¤×¡ ××©×—×§×™×</th>
                    <th style="width: 20%">×”×•×“×¤×¡ ×¤×™×¨×•×˜</th>
                    <th class="no-print" style="width: 50px"></th>
                </tr>
            </thead>
            <tbody id="tableBody">
                </tbody>
        </table>
    </div>

<script>
    // --- ××©×ª× ×™× ×’×œ×•×‘×œ×™×™× ---
    const days = ["×¨××©×•×Ÿ", "×©× ×™", "×©×œ×™×©×™", "×¨×‘×™×¢×™", "×—××™×©×™", "×©×™×©×™", "×©×‘×ª"];

    // --- ××ª×—×•×œ ---
    window.onload = function() {
        loadData();
        // ×× ××™×Ÿ × ×ª×•× ×™×, ×©×™× ×™×•× × ×•×›×—×™ ×•-5 ×©×•×¨×•×ª
        if(document.getElementById('tableBody').children.length === 0) {
            document.getElementById('dayInput').value = days[new Date().getDay()];
            for(let i=0; i<5; i++) addRow();
        }
    };

    // --- ×”×•×¡×¤×ª ×©×•×¨×” ---
    function addRow(vals = ['', '', '', '', '']) {
        const tbody = document.getElementById('tableBody');
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><input type="text" value="${vals[0]}" oninput="saveData()"></td>
            <td><input type="number" value="${vals[1]}" oninput="saveData()"></td>
            <td><input type="number" value="${vals[2]}" oninput="saveData()"></td>
            <td><input type="text" value="${vals[3]}" oninput="saveData()"></td>
            <td><input type="text" value="${vals[4]}" oninput="saveData()"></td>
            <td class="no-print" style="text-align:center; cursor:pointer; color:red; font-weight:bold;" onclick="removeRow(this)">X</td>
        `;
        tbody.appendChild(row);
    }

    function removeRow(btn) {
        btn.parentElement.remove();
        saveData();
    }

    // --- ×©××™×¨×” ×•×˜×¢×™× ×” ---
    function saveData() {
        // ×©×•××¨ ×¨×§ ×× ×× ×—× ×• ×œ× ×‘××¦×‘ "×“×£ ×¨×™×§" (×œ×× ×™×¢×ª ×“×¨×™×¡×”)
        if (sessionStorage.getItem('printingEmpty') === 'true') return;

        const rows = [];
        document.querySelectorAll('#tableBody tr').forEach(tr => {
            const inputs = tr.querySelectorAll('input');
            rows.push([inputs[0].value, inputs[1].value, inputs[2].value, inputs[3].value, inputs[4].value]);
        });
        const header = {
            day: document.getElementById('dayInput').value,
            name: document.getElementById('nameInput').value,
            route: document.getElementById('routeInput').value
        };
        localStorage.setItem('kobiTable_v3', JSON.stringify({ rows, header }));
    }

    function loadData() {
        const data = JSON.parse(localStorage.getItem('kobiTable_v3'));
        if (data) {
            document.getElementById('dayInput').value = data.header.day;
            document.getElementById('nameInput').value = data.header.name;
            document.getElementById('routeInput').value = data.header.route;
            data.rows.forEach(r => addRow(r));
        }
    }

    // --- ×”×¤×•× ×§×¦×™×” ×”××™×•×—×“×ª ×œ×”×“×¤×¡×” ×¨×™×§×” ---
    function printEmptySheet() {
        if(!confirm("×œ×”×›×™×Ÿ ×“×£ ×¨×™×§ (40 ×©×•×¨×•×ª) ×œ×”×“×¤×¡×”?")) return;
        
        // 1. ×©××™×¨×ª ×”××¦×‘ ×”× ×•×›×—×™ ×œ×™×ª×¨ ×‘×™×˜×—×•×Ÿ
        saveData();
        
        // 2. ×¡×™××•×Ÿ ×©×× ×—× ×• ×‘××¦×‘ ×”×“×¤×¡×” (×›×“×™ ×œ× ×œ×©××•×¨ ×‘×˜×¢×•×ª ××ª ×”×¨×™×§)
        sessionStorage.setItem('printingEmpty', 'true');

        // 3. × ×™×§×•×™ ×”×˜×‘×œ×” ×•×™×¦×™×¨×ª 40 ×©×•×¨×•×ª ×¨×™×§×•×ª
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';
        
        // × ×™×§×•×™ ×›×•×ª×¨×•×ª ×¨×§ ×œ×ª×¦×•×’×”
        document.getElementById('dayInput').value = ''; 
        document.getElementById('nameInput').value = ''; 
        document.getElementById('routeInput').value = ''; 

        for(let i=0; i<40; i++) { // 40 ×©×•×¨×•×ª ×–×” ×‘×¢×¨×š ×“×£ A4 ××œ×
            const row = document.createElement('tr');
            row.innerHTML = `
                <td></td><td></td><td></td><td></td><td></td>
                <td class="no-print"></td>
            `;
            tbody.appendChild(row);
        }

        // 4. ×”×“×¤×¡×”
        setTimeout(() => {
            window.print();
            // 5. ×¨×¢× ×•×Ÿ ×”×“×£ ×›×“×™ ×œ×”×—×–×™×¨ ××ª ×”× ×ª×•× ×™× ×”××§×•×¨×™×™×
            location.reload(); 
        }, 500);
    }

    function resetAll() {
        if(confirm("×œ××—×•×§ ×”×›×œ?")) {
            localStorage.removeItem('kobiTable_v3');
            location.reload();
        }
    }
</script>

</body>
</html>
